# 🚀 快速启动和测试指南

## 快速启动

### 1. 启动开发服务器

```powershell
cd c:\Users\Administrator\Desktop\rust_engine\scanner
cargo tauri dev
```

**预期输出:**
```
     Running `tauri dev`
    Waiting for frontend compilation...
[WebBundle] Building with bundler: Windows nativeOptions...
    Finished dev [unoptimized + debuginfo] target(s) in X.XXs
```

### 2. 应用启动

- 应该看到窗口打开
- 搜索框应该自动获得焦点 (可以直接输入)
- 看到提示文字: "⌨️ Enter=搜索 | F5=刷新 | ↑↓=选择 | Ctrl+C=复制 | Ctrl+L=定位 | Delete=删除 | Esc=清空"

---

## 功能测试清单

### 基础搜索
- [ ] 在搜索框输入 "test"
- [ ] 按 `Enter` 或 等待自动搜索
- [ ] 应该看到匹配的文件列表

### 🟢 测试 F5 (刷新搜索)

**步骤:**
1. 输入 "test" 并等待搜索完成
2. 按 `F5`
3. 搜索应该重新执行 (可能有加载动画)

**预期结果:** ✅ 搜索结果重新加载

---

### 🟢 测试 Escape (清空/关闭)

**步骤 1 - 清空模式:**
1. 输入 "test"
2. 按 `Escape`
3. 搜索框文本应该被清除
4. 结果列表应该清空 (显示 "输入关键词开始搜索...")

**步骤 2 - 关闭模式:**
1. 在空的搜索框中再次按 `Escape`
2. 窗口应该关闭

**预期结果:** ✅ 智能切换清空/关闭

---

### 🟡 测试 ↑/↓ (选择结果)

**步骤:**
1. 搜索 "test" (至少 3 个结果)
2. 按 `↓` 下箭头
3. 第一项应该被高亮 (背景色变化)
4. 再按 `↓` 移动到第二项
5. 按 `↑` 向上移动

**预期结果:** ✅ 在结果间导航, 清晰的视觉反馈

---

### 🔴 测试关键词高亮 (最重要!)

**步骤:**
1. 搜索 "test"
2. 查看结果列表中的文件名
3. 在文件名中找到与搜索词匹配的部分

**预期结果:** ✅ 匹配的文本应该有黄色背景 (`#ffeb3b`)

**如果失败:**
- 检查浏览器开发者工具 (F12)
- 查看 Console 标签有无错误
- 检查 `<mark>` 标签是否生成
- 验证 CSS 样式是否应用: `.result-filename mark { background-color: #ffeb3b; }`

---

### 🟢 测试 Ctrl+C (复制路径)

**步骤:**
1. 搜索结果中选择一个文件 (用 ↓ 键)
2. 按 `Ctrl+C`
3. 打开记事本或其他文本编辑器
4. 按 `Ctrl+V` 粘贴

**预期结果:** ✅ 文件的完整路径被复制到剪贴板

**示例:**
```
C:\Users\Administrator\Desktop\test.txt
```

---

### 🟡 测试 Ctrl+L (定位文件)

**步骤:**
1. 选择一个搜索结果
2. 按 `Ctrl+L`
3. 文件管理器应该打开, 并在该文件上选中显示

**预期结果:** ✅ 文件管理器打开, 文件被高亮显示

---

### 🟡 测试 Delete (删除文件)

**步骤:**
1. 搜索一个可以安全删除的文件 (或创建临时测试文件)
2. 选择该文件
3. 按 `Delete` 键
4. 应该看到确认对话框: "确定要删除 [filename] 吗?"
5. 点击 "确定" 确认删除

**预期结果:** ✅ 文件被删除, 从列表中移除

⚠️ **注意:** 小心操作! 这会真实删除文件!

---

### 🔴 测试 Ctrl+E (导出 CSV)

**步骤:**
1. 搜索一些文件 (至少 2-3 个结果)
2. 按 `Ctrl+E`
3. 浏览器应该下载一个文件: `search_results_TIMESTAMP.csv`

**验证导出文件:**
1. 打开下载的 CSV 文件
2. 应该看到:
   - 第一行: 表头 `"文件名","完整路径","大小 (字节)","大小 (可读)","修改时间"`
   - 后续行: 搜索结果数据

**CSV 示例:**
```
"文件名","完整路径","大小 (字节)","大小 (可读)","修改时间"
"test.txt","C:\Users\test.txt","1024","1 KB","2024-01-15 14:30:00"
"test2.pdf","C:\Users\test2.pdf","2048","2 KB","2024-01-14 10:15:30"
```

**预期结果:** ✅ CSV 文件格式正确, 可在 Excel 中打开

---

### 🟢 测试 Ctrl+A (全选)

**步骤:**
1. 搜索结果中有多个文件
2. 按 `Ctrl+A`
3. 所有结果项应该被选中 (视觉上有背景色变化)
4. 再按 `Ctrl+A` 应该取消全选

**预期结果:** ✅ 结果项显示选中状态

---

### 🟡 测试 Ctrl+Shift+C (复制文件)

**步骤:**
1. 选择一个文件
2. 按 `Ctrl+Shift+C`
3. 打开文件管理器, 按 `Ctrl+V` 粘贴

**预期结果:** ✅ 文件被复制到剪贴板 (需要 Rust 后端支持)

**当前状态:** ⚠️ 框架已实现, 需要后端支持

---

## 🐛 常见问题排查

### 问题 1: 快捷键不起作用
- [ ] 确保焦点不在搜索框上 (某些快捷键需要)
- [ ] 检查浏览器开发者工具 Console 有无错误
- [ ] 尝试重启应用

### 问题 2: 高亮不显示
- [ ] 打开 DevTools (F12) → Elements
- [ ] 搜索 `<mark>` 标签
- [ ] 检查是否生成了 HTML
- [ ] 如果没有 `<mark>`, 问题在 JavaScript
- [ ] 如果有 `<mark>` 但没有黄色背景, 问题在 CSS

### 问题 3: 导出失败
- [ ] 检查浏览器下载设置
- [ ] 尝试在浏览器开发者工具 Console 手动调用 `exportResults()`
- [ ] 检查文件权限

### 问题 4: 搜索很慢
- [ ] 这是正常的 (第一次搜索需要扫描目录)
- [ ] 之后会使用索引缓存 (更快)
- [ ] 按 F5 强制刷新索引

---

## 📊 测试报告模板

完成测试后, 填写此模板:

```
# SearchTool 功能测试报告

**日期:** YYYY-MM-DD  
**测试人:** [你的名字]  
**应用版本:** v0.1-alpha  
**操作系统:** Windows 10/11  

## 测试结果

### 高优先级功能 (必须通过)
- [ ] F5 刷新: ✅ 通过 / ❌ 失败
- [ ] Escape 清空: ✅ 通过 / ❌ 失败
- [ ] 关键词高亮: ✅ 通过 / ❌ 失败
- [ ] Ctrl+E 导出: ✅ 通过 / ❌ 失败

### 中优先级功能
- [ ] ↑↓ 选择: ✅ 通过 / ❌ 失败
- [ ] Ctrl+C 复制: ✅ 通过 / ❌ 失败
- [ ] Ctrl+L 定位: ✅ 通过 / ❌ 失败
- [ ] Delete 删除: ✅ 通过 / ❌ 失败

### 低优先级功能
- [ ] Ctrl+A 全选: ✅ 通过 / ❌ 失败
- [ ] Ctrl+Shift+C 复制文件: ✅ 通过 / ❌ 失败

## 发现的问题

### Bug 1: [描述问题]
- 重现步骤: ...
- 预期: ...
- 实际: ...
- 严重程度: 🔴 严重 / 🟡 中等 / 🟠 轻微

## 总体评分

**功能完整性:** 100% / 80% / 60% ...  
**代码质量:** ⭐⭐⭐⭐⭐ / ⭐⭐⭐⭐ ...  
**用户体验:** ⭐⭐⭐⭐⭐ / ⭐⭐⭐⭐ ...  

## 备注

[任何额外的观察或建议]
```

---

## 💡 调试技巧

### 打开浏览器开发者工具
```javascript
// 按 F12 打开开发者工具
// 或在应用中运行:
window.open('devtools://devtools/bundled/inspector.html')
```

### 在 Console 中测试函数
```javascript
// 测试导出
exportResults()

// 测试高亮
highlightKeywords("test filename", ["test"])

// 查看状态
console.log(state)

// 查看 DOM 结构
console.log(DOM)
```

### 查看网络请求
- DevTools → Network 标签
- 执行搜索时观察请求
- 查看返回的 JSON 数据

### 查看性能
- DevTools → Performance 标签
- 点击"Record"
- 执行搜索
- 停止记录并分析耗时

---

## 🎯 成功标准

应用被认为是"功能完整"当:
- ✅ 所有 4 个高优先级功能都能正常工作
- ✅ 没有 JavaScript 错误
- ✅ 没有 UI 崩溃或冻结
- ✅ 导出的 CSV 可以在 Excel 中打开
- ✅ 关键词高亮清晰可见

---

**准备好测试了吗?** 🚀  
运行 `cargo tauri dev` 开始吧!
